/*
 * ai_minmax.c
 *
 *  Created on: 2025. 12. 2.
 *      Author: USER
 */

#include "ai_minmax.h"
#include <stdint.h>

void ai_minmax_scale(const float *x, float *x_scaled, int len)
{
    for (int i = 0; i < len; i++) {
        float v    = x[i];
        float vmin = AE_X_MIN[i];
        float vmax = AE_X_MAX[i];
        float norm = 0.0f;

        if (vmax > vmin) {
            norm = (v - vmin) / (vmax - vmin);
        }

        if (norm < 0.0f) norm = 0.0f;
        if (norm > 1.0f) norm = 1.0f;

        x_scaled[i] = norm;
    }
}

void ai_minmax_inverse_scale(const float *x_scaled, float *x, int len)
{
    for (int i = 0; i < len; i++) {
        float norm = x_scaled[i];
        float vmin = AE_X_MIN[i];
        float vmax = AE_X_MAX[i];

        /* 필요하면 norm 클램핑 */
        if (norm < 0.0f) norm = 0.0f;
        if (norm > 1.0f) norm = 1.0f;

        x[i] = norm * (vmax - vmin) + vmin;
    }
}

const float AE_X_MIN[AE_COLS] = {
		-1.895502691695583e-06,
		    -1.675051862548571e-05,
		    -1.0857032066269312e-05,
		    -2.4249015041277744e-05,
		    -2.410436536592897e-05,
		    -9.171312740363646e-06,
		    -7.093722615536535e-06,
		    -1.3716821740672458e-05,
		    -1.2011594208161114e-06,
		    -1.727139897411689e-05,
		    -3.34246942657046e-05,
		    -2.05075502890395e-05,
		    -2.9222295779618435e-05,
		    -5.9276146203046665e-05,
		    -9.404554475622717e-06,
		    -9.608247637515888e-06,
		    -7.485369678761344e-06,
		    -4.534605977823958e-05,
		    -3.170495619997382e-05,
		    -5.168198549654335e-05,
		    -0.00012618734035640955,
		    -2.715374284889549e-05,
		    -3.853784073726274e-05,
		    -3.664322503027506e-05,
		    -2.9905784685979597e-05,
		    -4.378152880235575e-05,
		    -1.4849769286229275e-05,
		    -1.405125658493489e-05,
		    -2.423962541797664e-05,
		    -1.3484870578395203e-05,
		    -1.1563774023670703e-05,
		    -2.7436501113697886e-05,
		    -1.3507198673323728e-05,
		    -3.348314203321934e-05,
		    -5.677235549228499e-06,
		    -2.2007710867910646e-05,
		    -1.2447199878806714e-05,
		    -1.0064049092761707e-05,
		    -4.9166315875481814e-05,
		    -2.2490463379654102e-05,
		    -7.03455179973389e-06,
		    -2.697572017495986e-05,
		    -3.5173223295714706e-05,
		    -2.7286190743325278e-05,
		    -7.1384288276021834e-06,
		    -6.368211870722007e-06,
		    -1.362646980851423e-05,
		    -1.6106907423818484e-05,
		    -9.599750228517223e-06,
		    -3.945944172301097e-06,
		    -7.430301593558397e-06,
		    -3.2514892609469825e-06,
		    -2.2475558580481447e-05,
		    -1.8845663362299092e-05,
		    -5.5129221436800435e-06,
		    -2.4261851194751216e-06,
		    -4.948382866132306e-06,
		    -1.595033609191887e-06,
		    -2.0757172478624852e-06,
		    -5.155754479346797e-06,
		    -1.3762663002125919e-05,
		    -9.9009657787974e-06,
		    -1.4775040654058103e-05,
		    -4.263079972588457e-06,
		    -2.041999323409982e-05,
		    -1.7728547391016036e-05,
		    -7.1336185101245064e-06,
		    -1.4705148714710958e-05,
		    -2.6773095669341274e-06,
		    -1.28291649161838e-05,
		    -1.2029913705191575e-05,
		    -1.687820622464642e-05,
		    -1.2106486792617943e-05,
		    -2.153780951630324e-05,
		    -5.5188302212627605e-06,
		    -1.605622173883603e-06,
		    -6.130087513156468e-06,
		    -1.0879990441026166e-05,
		    -1.576457725604996e-05,
		    -1.8277098206453957e-05,
		    -1.3383736586547457e-05,
		    -2.3015105398371816e-05,
		    -2.4474915335304104e-05,
		    -2.703285099414643e-05,
		    -4.8156525735976174e-06,
		    -2.453528213663958e-05,
		    -4.679162157117389e-05,
		    -1.621906994841993e-05,
		    -8.847200092532148e-07,
		    -4.17685305365012e-06,
		    -4.350497874838766e-06,
		    -1.0086905604111962e-05,
		    -1.3678520190296695e-05,
		    -2.669422201506677e-06,
		    -1.2090424206689931e-05,
		    -8.618664651294239e-06,
		    -5.429464636108605e-06,
		    -1.7258641946682474e-06,
		    -1.4490269677480683e-05,
		    -4.943080057273619e-06,
		    -1.63813656399725e-05,
		    -4.692078164225677e-06,
		    -1.2304348274483345e-05,
		    -6.578404281754047e-06,
		    -4.4725329644279554e-06,
		    -4.8423189582536e-06,
		    -4.247644028509967e-06,
		    -3.267107967985794e-05,
		    -5.893929937883513e-06,
		    -6.343577751977136e-06,
		    -8.653069016872905e-06,
		    -9.996057997341268e-06,
		    -2.1226569515420124e-05,
		    -1.9033470834983746e-06,
		    -1.0913386176980566e-05,
		    -1.4748097783012781e-05,
		    -2.0901556126773357e-05,
		    -1.3223047062638216e-05,
		    -2.134412397936103e-06,
		    -1.0293646482750773e-05,
		    -9.801557098398916e-06,
		    -7.4488766586000565e-06,
		    -1.4803968952037394e-05,
		    -3.240571459173225e-06,
		    -1.4211059351509903e-05,
		    -1.498302367508586e-06,
		    -1.4085405382502358e-05,
		    -4.494169843383133e-06,
		    -10.170125007629395,
		    -0.0012040939182043076
};

const float AE_X_MAX[AE_COLS] = {
		0.005415722262114286,
		    0.00627360213547945,
		    0.011428454890847206,
		    0.009362554177641869,
		    0.009565223939716816,
		    0.007054856047034264,
		    0.011441487818956375,
		    0.00979773048311472,
		    0.012011595070362091,
		    0.026571383699774742,
		    0.030664857476949692,
		    0.034758560359478,
		    0.037464480847120285,
		    0.04060009866952896,
		    0.036171361804008484,
		    0.04177498817443848,
		    0.05346692353487015,
		    0.050384510308504105,
		    0.06745735555887222,
		    0.0654202327132225,
		    0.07379376888275146,
		    0.056570298969745636,
		    0.04188895598053932,
		    0.04211864992976189,
		    0.047469496726989746,
		    0.04467502981424332,
		    0.029117194935679436,
		    0.023418759927153587,
		    0.041084110736846924,
		    0.029966378584504128,
		    0.05256260931491852,
		    0.04572749882936478,
		    0.04502399265766144,
		    0.03600338101387024,
		    0.04055168107151985,
		    0.044015418738126755,
		    0.034575555473566055,
		    0.041933540254831314,
		    0.045106709003448486,
		    0.0468551330268383,
		    0.041379716247320175,
		    0.04995504021644592,
		    0.05249734967947006,
		    0.05247344449162483,
		    0.03569214418530464,
		    0.01721138320863247,
		    0.04395635426044464,
		    0.03928513824939728,
		    0.02133277803659439,
		    0.028185313567519188,
		    0.03230565786361694,
		    0.016257446259260178,
		    0.045868486166000366,
		    0.03426484391093254,
		    0.007350562606006861,
		    0.004757225979119539,
		    0.00838708970695734,
		    0.004984480328857899,
		    0.007413276005536318,
		    0.0081837372854352,
		    0.015123805031180382,
		    0.030940517783164978,
		    0.03283342346549034,
		    0.035525668412446976,
		    0.037814803421497345,
		    0.036180708557367325,
		    0.02853447198867798,
		    0.022280527278780937,
		    0.02231091447174549,
		    0.026727426797151566,
		    0.03341642767190933,
		    0.04219551756978035,
		    0.04656340926885605,
		    0.04487043619155884,
		    0.05518830195069313,
		    0.040140554308891296,
		    0.029190892353653908,
		    0.0388571061193943,
		    0.056302059441804886,
		    0.06527534872293472,
		    0.06083516776561737,
		    0.06974273920059204,
		    0.08158304542303085,
		    0.07950838655233383,
		    0.08026088029146194,
		    0.07434933632612228,
		    0.06498835980892181,
		    0.06007063016295433,
		    0.029490668326616287,
		    0.026105331256985664,
		    0.033465366810560226,
		    0.03879579156637192,
		    0.02973591350018978,
		    0.03336777910590172,
		    0.0503767691552639,
		    0.045361392199993134,
		    0.0217178575694561,
		    0.021573303267359734,
		    0.04996644705533981,
		    0.06178850308060646,
		    0.043108854442834854,
		    0.020400339737534523,
		    0.03417874500155449,
		    0.01777947135269642,
		    0.022362664341926575,
		    0.023058662191033363,
		    0.03267418593168259,
		    0.06050200015306473,
		    0.045337922871112823,
		    0.05286315083503723,
		    0.06180763244628906,
		    0.03998422995209694,
		    0.040820326656103134,
		    0.047583676874637604,
		    0.07275590300559998,
		    0.08675351738929749,
		    0.06147516518831253,
		    0.047225166112184525,
		    0.03557354211807251,
		    0.02708854153752327,
		    0.04900778830051422,
		    0.05320626124739647,
		    0.0672907680273056,
		    0.04629387706518173,
		    0.07479504495859146,
		    0.07491511851549149,
		    0.07413370907306671,
		    0.07490283250808716,
		    0.4149377942085266,
		    0.02921445667743683
};

